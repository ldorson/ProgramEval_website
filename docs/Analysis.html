<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Synthetic Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="Theory.html">Program Theory and Implementation</a>
</li>
<li>
  <a href="Outcome.html">Outcome and Causation</a>
</li>
<li>
  <a href="Data.html">Data and Methods</a>
</li>
<li>
  <a href="Analysis.html">Synthetic Analysis</a>
</li>
<li>
  <a href="Conclusion.html">Conclusion</a>
</li>
<li>
  <a href="Download.html">Synthetic Data Download</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Synthetic Analysis</h1>

</div>


<p>Synthetic Differences in Differences</p>
<p>Generate a synthetic (fake) dataset in R with all the variables
you’ll need for the real life analysis. Analyze the data using your
identification strategy. For instance:</p>
<ul>
<li>If you’re relying on observational data, close all the backdoors
with matching or inverse probability weighting, don’t adjust for
colliders, and make a strong argument for isolation of the causal effect
in the absence of treatment/control groups</li>
<li>If you’re doing an RCT, test the differences in means in the
treatment and control groups (and follow all other best practices listed
in the World Bank book, checking for balance across groups, etc.)</li>
<li>If you’re doing diff-in-diff, run a regression model with an
interaction term to show the diff-in-diff</li>
<li>If you’re doing regression discontinuity, check for a jump in the
outcome variable at the cutoff in the running variable</li>
<li>If you’re using instrumental variables, check the validity of your
instrument and run a 2SLS model</li>
</ul>
<p>Include robustness checks to ensure the validity of your effect
(i.e. if you’re doing regression discontinuity, test different
bandwidths and kernel types; etc.)</p>
<p>(<strong>As many words as you need to fully describe your analysis
and results</strong>)</p>
<pre class="r"><code>#packages
library(tidyverse)
library(broom)
library(patchwork)
library(scales)</code></pre>
<pre class="r"><code>set.seed(4660)

# simulate 100000 students
n_students &lt;- 100000


# state B represents Georgia (treatment state) while state B represents control state
did_data &lt;- tibble(
  id = 1:n_students,
  year = round(runif(n_students, min = 1988, max = 1997), 0),
  state = sample(c(&quot;state A&quot;, &quot;state B&quot;), n_students, replace = TRUE)
) %&gt;%
  mutate(hope = ifelse(state == &quot;state B&quot; &amp; year &gt; 1992, TRUE, FALSE)) %&gt;%
  mutate(grad_base = rbeta(n_students, shape1 = 6, shape2 = 3) * 100,
         state_effect = ifelse(state == &quot;state B&quot;, rnorm(n_students, mean = 4, sd = 2), 0),
         year_smaller = year - 1987,
         year_effect = rnorm(n_students, mean = -3, sd = 0.2) * year_smaller,
         hope_effect = ifelse(state == &quot;state B&quot; &amp; year &gt; 1992,
                             rnorm(n_students, mean = -8, sd = 2),
                             0),
         grad = grad_base + state_effect + year_effect + hope_effect,
         grad = rescale(grad, to = c(0, 100))) %&gt;%
  mutate(after = year &gt; 1992)

head(did_data)</code></pre>
<pre><code>## # A tibble: 6 × 11
##      id  year state   hope  grad_base state_effect year_smaller year_effect hope_effect  grad after
##   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;lgl&gt;     &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;
## 1     1  1995 state B TRUE       67.1         5.49            8      -27.3        -6.69  51.9 TRUE 
## 2     2  1990 state A FALSE      79.0         0               3       -9.60        0     76.0 FALSE
## 3     3  1994 state A FALSE      51.3         0               7      -21.2         0     45.2 TRUE 
## 4     4  1990 state A FALSE      74.8         0               3       -8.76        0     73.4 FALSE
## 5     5  1995 state B TRUE       75.1         2.88            8      -20.7        -6.36  61.6 TRUE 
## 6     6  1994 state B TRUE       73.1         7.03            7      -20.1        -7.04  63.2 TRUE</code></pre>
<pre class="r"><code>ggplot(did_data, aes(x = state, y = grad, color = state)) +
  stat_summary(geom = &quot;pointrange&quot;, fun.data = &quot;mean_se&quot;) +
  guides(color = &quot;none&quot;)</code></pre>
<p><img src="Analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>plot_data &lt;- did_data %&gt;%
  group_by(year, state) %&gt;%
  summarize(mean = mean(grad),
            se = sd(grad) / sqrt(n()),
            upper = mean + (1.96 * se),
            lower = mean + (-1.96 * se))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>ggplot(plot_data, aes(x = year, y = mean, color = state)) +
  geom_vline(xintercept = 1993) +
  geom_ribbon(aes(ymin = lower, ymax = upper, fill = state), alpha = 0.3, color = FALSE) +
  geom_line() +
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="Analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>model_did &lt;- lm(grad ~ after + state + hope , data = did_data)
tidy(model_did)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term         estimate std.error statistic   p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)     66.3     0.0775     855.  0        
## 2 afterTRUE      -10.6     0.109      -96.9 0        
## 3 statestate B     3.27    0.109       29.9 3.64e-196
## 4 hopeTRUE        -6.43    0.154      -41.6 0</code></pre>
<pre class="r"><code>modelsummary(list(&quot;DiD&quot; = model_did),
             stars = TRUE,
             title = &quot; Synthetic Regression Results&quot;)</code></pre>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<caption>
Synthetic Regression Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
DiD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
66.281***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.078)
</td>
</tr>
<tr>
<td style="text-align:left;">
afterTRUE
</td>
<td style="text-align:center;">
−10.589***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.109)
</td>
</tr>
<tr>
<td style="text-align:left;">
statestate B
</td>
<td style="text-align:center;">
3.272***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.109)
</td>
</tr>
<tr>
<td style="text-align:left;">
hopeTRUE
</td>
<td style="text-align:center;">
−6.425***
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.154)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
100000
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.252
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.252
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
784154.0
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
784201.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
−392071.986
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
11245.100
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
12.20
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt;
0.001
</td>
</tr>
</tfoot>
</table>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
